<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Certificado <%= certNumber %></title>
  <style>
    * { box-sizing: border-box; }
    body { font-family: 'Helvetica','Arial',sans-serif; margin:0; padding:0; background:#f7f7f9; color:#2c2c2c; }
    .page { position: relative; width: 100%; height: 100%; padding:40px 50px; }
    .border-outer { position:absolute; top:25px; left:25px; right:25px; bottom:25px; border:3px solid #1B365D; border-radius:4px; }
    .border-inner { position:absolute; top:38px; left:38px; right:38px; bottom:38px; border:1px solid #D4AF37; border-radius:4px; }
    header { background:#1B365D; color:#fff; padding:25px 40px; display:flex; align-items:center; gap:25px; }
    .logo { width:60px; height:60px; border:2px solid #D4AF37; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:700; font-size:22px; background:#fff; color:#1B365D; }
    h1 { margin:0; font-size:26px; letter-spacing:1px; }
    h2.sub { margin:4px 0 0; font-size:16px; font-weight:400; letter-spacing:1px; }
    .decor-line { margin:22px auto 14px; height:2px; width:78%; background:linear-gradient(90deg,#fff,#D4AF37,#fff); position:relative; }
    .decor-dots { display:flex; justify-content:center; gap:14px; margin-bottom:30px; }
    .decor-dots span { width:10px; height:10px; background:#D4AF37; border-radius:50%; }
    .intro { text-align:center; font-size:17px; }
    .name-box { margin:25px auto 10px; width:70%; background:rgba(212,175,55,.15); padding:18px 25px; text-align:center; border:1px solid rgba(212,175,55,.35); }
    .name-box .name { font-size:32px; font-weight:700; letter-spacing:2px; color:#1B365D; margin:0; }
    .email { text-align:center; font-size:12px; font-style:italic; color:#555; margin:4px 0 18px; }
    .details { width:82%; margin:0 auto; background:#ffffff; border:1px solid #F4E4B8; padding:22px 30px 26px; position:relative; }
    .details h3 { text-align:center; margin:0 0 18px; color:#1B365D; letter-spacing:1px; font-size:15px; }
    .row { display:flex; font-size:12px; margin-bottom:6px; padding:6px 8px; border-radius:3px; }
    .row.alt { background:#f8f8f8; }
    .row b { width:180px; color:#1B365D; font-weight:600; }
    .row span { flex:1; color:#333; }
    footer.authority { margin:55px auto 0; width:82%; background:#1B365D; color:#fff; padding:25px 30px 70px; position:relative; text-align:center; }
    footer.authority h4 { margin:0; font-size:20px; letter-spacing:1px; }
    footer.authority p { margin:10px auto 6px; font-size:11px; line-height:1.4; max-width:90%; color:#F4E4B8; }
    .cert-number { font-size:11px; color:#F4E4B8; margin:4px 0 0; }
    .seal { position:absolute; left:70px; bottom:25px; width:90px; height:90px; border:3px solid #D4AF37; border-radius:50%; display:flex; flex-direction:column; align-items:center; justify-content:center; font-size:11px; font-weight:700; color:#D4AF37; }
    .seal:after { content:""; position:absolute; inset:10px; border:1px solid #D4AF37; border-radius:50%; }
    .signature { position:absolute; right:90px; bottom:55px; width:180px; text-align:center; }
    .signature .line { height:1px; background:#fff; margin-bottom:6px; }
    .signature span { font-size:12px; font-weight:600; letter-spacing:.5px; }
    .issued { position:absolute; right:40px; bottom:22px; font-size:10px; color:#eee; }
    .qr { position:absolute; right:40px; bottom:105px; width:70px; height:70px; background:#1B365D; display:grid; grid-template-columns:repeat(6,1fr); grid-template-rows:repeat(6,1fr); gap:3px; padding:6px; }
    .qr div { background:#fff; }
    .watermark { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%) rotate(-25deg); font-size:120px; font-weight:700; letter-spacing:4px; color:rgba(212,175,55,0.08); pointer-events:none; white-space:nowrap; }
  </style>
</head>
<body>
  <div class="page">
    <div class="watermark">CERTIFICADO</div>
    <div class="border-outer"></div>
    <div class="border-inner"></div>
    <header>
      <div class="logo">IC</div>
      <div>
        <h1>CERTIFICATE OF COMPLIANCE</h1>
        <h2 class="sub">CERTIFICADO DE CONFORMIDAD</h2>
      </div>
    </header>
    <div class="decor-line"></div>
    <div class="decor-dots"><span></span><span></span><span></span><span></span><span></span></div>

    <p class="intro">This certificate is hereby granted to:</p>

    <div class="name-box">
      <h2 class="name"><%= user.name.toUpperCase() %></h2>
    </div>
    <p class="email"><%= user.email %></p>

    <section class="details">
      <h3>CERTIFICATION DETAILS</h3>
      <% const _safe = v => (typeof v === 'string' ? v.trim() : (v??''));
         const _costFmt = (typeof cost === 'number') ? `$${cost.toFixed(2)} USD` : '';
         const _certType = certificationType ? certificationType.replace(/_/g,' ') : '';
         const _descRaw = _safe(projectDescription);
         const _desc = _descRaw.length>80 ? _descRaw.substring(0,77)+'...' : _descRaw;
         const rows = [
           ['Tipo de Certificación', _certType],
           ['Nombre del Proyecto', _safe(projectName)],
           ['Descripción', _desc],
           ['URL del Proyecto', _safe(projectUrl)],
           ['Repositorio', _safe(repoUrl)],
           ['Empresa', _safe(companyName)],
           ['Dirección Empresa', _safe(companyAddress)],
           ['Plataforma', _safe(appPlatform)],
           ['Costo de Certificación', _costFmt],
           ['Fecha de Emisión', updatedAt ? new Date(updatedAt).toLocaleDateString('es-ES') : '']
         ].filter(r=> r[1]);
      %>
      <% rows.forEach((r,i)=> { %>
        <div class="row <%= i%2===0? 'alt':'' %>"><b><%= r[0] %>:</b><span><%= r[1] %></span></div>
      <% }) %>
    </section>

    <footer class="authority">
      <h4>INSPECTIA CERTIFICATION AUTHORITY</h4>
      <p>El presente documento certifica que la solicitud cumple los criterios de evaluación establecidos.</p>
      <p class="cert-number">Certificate No: <%= certNumber %></p>
      <div class="seal">OFFICIAL<br/>SEAL</div>
      <div class="issued">Emitido el: <%= new Date().toLocaleDateString('es-ES') %></div>
    </footer>
  </div>
</body>
</html>
